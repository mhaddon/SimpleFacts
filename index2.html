<!DOCTYPE html>
<html>
    <head>
        <title>Simple Facts</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script type='text/javascript' src='Include/JS/vue-dev.js'></script>
        <link rel='stylesheet' type='text/css' href='Include/CSS/stylesheet.css'/>
    </head>
    <body>
        <div style='display:block; margin:auto; width:500px;text-align:center; margin-top:50px;'>
            <h2>Simple Facts for Simple People</h2>
            <textarea name='message' id='messagebox' style='width:100%;'></textarea>
            <div id='messages'>

            </div>
        </div>
        <script type='text/javascript'>
            var chat = document.getElementById('messages');
            var msg = document.getElementById('messagebox');
            
            var socket = new WebSocket("wss://wss.haddon.me");
            var open = false;
            
            
            function addmsg(msg) {
                chat.innerHTML += "<p>" + msg + "</p>";
            }
            
            msg.addEventListener('keypress', function(e) {
                if (e.charCode !== 13) {
                    return;
                }
                
                e.preventDefault();
                
                if (msg.value.trim() === "" || !open) {
                    return;
                }
                
                socket.send(JSON.stringify({
                    msg: msg.value
                }));
                
                //addmsg(msg.value);
                
                msg.value = "";
            });
            
            socket.onopen = function() {
                open = true;
                
                addmsg('Connection to server established.');
            }
            
            socket.onmessage = function(e) {
                var data = JSON.parse(e.data);
                
                addmsg(data.msg);
            }
            
            socket.onclose = function() {
                open = true;
                
                addmsg('Connection to server terminated.');
                
            }
        </script>
    </body>
</html>
